!function(e){function t(t){for(var r,a,c=t[0],u=t[1],f=t[2],l=0,d=[];l<c.length;l++)a=c[l],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(s&&s(t);d.length;)d.shift()();return o.push.apply(o,f||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==i[u]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={71:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var f=0;f<c.length;f++)t(c[f]);var s=u;o.push([1265,2]),n()}({1265:function(e,t,n){e.exports=n(1300)},1300:function(e,t,n){"use strict";n.r(t);var r,i=window.__CORE__;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e[e.Nets=1]="Nets",e[e.Components=2]="Components",e[e.All=3]="All"}(r||(r={}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createInstance",value:function(e){for(var t=Object.create(e.prototype),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.constructor.apply(t,r),t}}],(n=null)&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c(this,e),s(this,"name",void 0),s(this,"item",void 0),s(this,"fit",void 0),this.name=n,this.item=t,this.fit=r}return f(e,[{key:"isNet",get:function(){return"net"===this.name}},{key:"isComponent",get:function(){return"component"===this.name}}],[{key:"createNet",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new e(t,"net",n)}},{key:"createComponent",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new e(t,"component",n)}}]),e}(),d=n(187);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(n,e);var t=v(n);function n(e){var r;return S(this,n),n.instance?m(r,n.instance):(j(b(r=t.call(this,e)),"documnentMap",void 0),r.documnentMap=r.buildMap(),r)}return w(n,[{key:"findById",value:function(e){var t,n=this.documnentMap.get(e);return n||(n=null===(t=this.metadata.schDocuments)||void 0===t?void 0:t.find((function(t){return t.id===e}))),n}},{key:"buildMap",value:function(){var e=new Map,t=this.metadata.channels,n=this.metadata.schDocuments;if(t&&n){var r=new Map;t.forEach((function(t){var i,o=n.find((function(e){return e.id==t.schId}));r.has(o.id)?i=r.get(o.id):(i=r.size+1,r.set(o.id,i)),o&&e.set(Object(d.a)(o.id,t.id),o)}))}else{var i;null===(i=this.metadata.schDocuments)||void 0===i||i.forEach((function(t){return e.set(t.id,t)}))}return e}}]),n}(w((function e(t){S(this,e),j(this,"metadata",void 0),this.metadata=t})));function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}j(O,"instance",void 0);var I=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),P(this,"metadata",void 0),P(this,"documnentSearchEngine",void 0),this.metadata=t,this.documnentSearchEngine=new O(t)}var t,n,r;return t=e,(n=[{key:"find",value:function(e,t){if(!t)return[];var n=this.metadata.components.filter((function(e){var n,r;return(null===(n=e.designator)||void 0===n?void 0:n.toUpperCase().includes(t.toUpperCase()))||(null===(r=e.comment)||void 0===r?void 0:r.toUpperCase().includes(t.toUpperCase()))}));return 0==n.length?[]:"pcb"===e.mode?this.findPcb(e,n):this.findSch(e,n)}},{key:"findPcb",value:function(e,t){var n=t.filter((function(e){return e.pcbId}));return n&&n.length?[this.createComponentSearchResult(this.metadata.pcbDocument.fileName,n)]:"pcb"==e.mode?this.findSch(e,t):[]}},{key:"findSch",value:function(e,t){var n,r=this,i=[],o=t.filter((function(e){return e.schDocId})),a=new Map;if(o.forEach((function(e){var t=Object(d.a)(e.schDocId,null);a.has(t)||a.set(t,[]);var n=a.get(t);n&&n.push(e)})),a.forEach((function(e,t){var n=r.documnentSearchEngine.findById(t),o=n?n.fileName:"SchDoc: ".concat(t),a=r.createComponentSearchResult(o,e);i.push(a)})),"pcb"===e.mode)return i;if(0==i.length)return this.findPcb(e,t);var c=null===(n=this.documnentSearchEngine.findById(e.currentDocId))||void 0===n?void 0:n.fileName,u=i.findIndex((function(e){return e.document==c}));return u>0&&i.unshift(i.splice(u,1)[0]),i}},{key:"createComponentSearchResult",value:function(e,t){var n=[];return t.forEach((function(e){return n.push(new l(e,"component"))})),{document:e,objects:n}}}])&&E(t.prototype,n),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),D(this,"metadata",void 0),D(this,"searchEngines",void 0),this.metadata=t,this.searchEngines=n}var t,n,r;return t=e,(n=[{key:"find",value:function(e,t){var n=this;if(!t)return[];var r=[];if(this.searchEngines.forEach((function(i){var o=n.createInstance(i).find(e,t);r.push(o)})),0==r.length)return[];var i=r[0];if(1==r.length)return i;for(var o=1;o<r.length;o++){var a=r[o];null==a||a.forEach((function(e){var t,n=i.find((function(t){return t.document==e.document}));n?(t=n.objects).push.apply(t,k(e.objects)):i.push(e)}))}return i}},{key:"createInstance",value:function(e){return a.createInstance(e,this.metadata)}}])&&M(t.prototype,n),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"metadata",void 0),R(this,"documnentSearchEngine",void 0),this.metadata=t,this.documnentSearchEngine=new O(t)}var t,n,r;return t=e,(n=[{key:"find",value:function(e,t){if(!t)return[];var n=this.metadata.nets.filter((function(e){return e.name&&e.name.toUpperCase().includes(t.toUpperCase())}));return 0==n.length?[]:"pcb"===e.mode?this.findPcb(e,n):this.findSch(e,n)}},{key:"findPcb",value:function(e,t){var n=this,r=t.filter((function(e){return n.exitsNetPrimitive(e,(function(e){return!!e.pcbId}))}));return r&&r.length?[this.createNetSearchResult(this.metadata.pcbDocument.fileName,r)]:"pcb"==e.mode?this.findSch(e,t):[]}},{key:"findSch",value:function(e,t){var n=this,r=[],i=t.filter((function(e){return n.exitsNetPrimitive(e,(function(e){return!!e.schDocId}))})),o=new Map;if(i.forEach((function(e){return n.searchInNet(e,o)})),o.forEach((function(e,t){var i=n.documnentSearchEngine.findById(t),o=i?i.fileName:"SchDoc: ".concat(t),a=n.createNetSearchResult(o,A(e.values()));r.push(a)})),"pcb"===e.mode)return r;if(0==r.length)return this.findPcb(e,t);var a=this.documnentSearchEngine.findById(e.currentDocId);if(!a)return r;var c=r.findIndex((function(e){return e.document===a.fileName}));return c>0&&r.unshift(r.splice(c,1)[0]),r}},{key:"searchInNet",value:function(e,t){var n=this;e.primitives.forEach((function(r){var i=n.metadata.primitivesMap.get(r);if(i&&i.schDocId){t.has(i.schDocId)||t.set(i.schDocId,new Set);var o=t.get(i.schDocId);if(o){var a=!1;if(o.forEach((function(t){t.name===e.name&&(a=!0)})),!a){var c=i.schDocId;if(n.metadata.channels){var u=n.metadata.channels.find((function(t){return t.schId===c&&e.name.endsWith("_".concat(t.name))}));u&&(c=Object(d.a)(c,u.id))}o.add({name:e.name,documentId:c,boundRects:e.boundRects,layersUsed:e.layersUsed,length:e.length,unroutedLength:e.unroutedLength,primitives:e.primitives})}}}}))}},{key:"createNetSearchResult",value:function(e,t){var n=[];return t.forEach((function(e){return n.push(new l(e,"net"))})),{document:e,objects:n}}},{key:"exitsNetPrimitive",value:function(e,t){for(var n=0,r=e.primitives.length;n<r;n++){var i=e.primitives[n],o=this.metadata.primitivesMap.get(i);if(o&&t(o))return!0}return!1}}])&&_(t.prototype,n),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),U(this,"logger",i.createLogger("SearchEngine")),U(this,"metadata",void 0),U(this,"searchEngines",new Map),U(this,"searchContextModes",new Map),U(this,"activeViewInstance",void 0),U(this,"onViewActivate",(function(e){t.activeViewInstance=e.instance})),this.searchEngines.set(r.Components,I),this.searchEngines.set(r.Nets,T),this.searchContextModes.set("SCHView","sch"),this.searchContextModes.set("PCBView","pcb"),this.searchContextModes.set("PCBView3D","pcb")}var t,n,o;return t=e,(n=[{key:"setup",value:function(e){var t=this;return this.logger.LogDebug("Setup"),i.bus.on("View:activate",this.onViewActivate),new Promise((function(e){var n,r=i.response,o=null==r?void 0:r.metadata;if(null!=o&&null!==(n=o.primitives)&&void 0!==n&&n.length)return o.primitivesMap=new Map,o.primitives.forEach((function(e,t){o.primitivesMap.set(t,o.primitives[t])})),t.metadata=o,void e(o);e()}))}},{key:"name",get:function(){return"SearchEngine"}},{key:"comment",get:function(){return"Search handler engine"}},{key:"dependencies",get:function(){return[]}},{key:"metaInfo",get:function(){return this}},{key:"events",get:function(){return["SearchEngine:beforeFound","SearchEngine:afterFound"]}},{key:"findObjects",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.All;if(!this.metadata||!e)return[];var n=[];this.searchEngines.forEach((function(e,r){0!=(t&r)&&n.push(e)}));var i=new x(this.metadata,n),o=this.createSearchContext(),a=i.find(o,e);return this.convertToDocumentSearchResult(a)}},{key:"convertToDocumentSearchResult",value:function(e){if(null==e||!e.length)return[];var t=[];return e.forEach((function(e,n){var i=[];e.objects.forEach((function(e,t){var n,o,a,c,u={id:t,text:(n=e,c="","component"===n.name?c=null===(o=n.item)||void 0===o?void 0:o.designator:"net"===n.name&&(c=null===(a=n.item)||void 0===a?void 0:a.name),c),type:"net"===e.name?r.Nets:r.Components,item:e.item};i.push(u)}));var o={id:n,label:e.document,items:i};t.push(o)})),t}},{key:"createSearchContext",value:function(){var e,t,n,r,i,o=null!==(e=this.searchContextModes.get(null===(t=this.activeViewInstance)||void 0===t||null===(n=t.metaInfo)||void 0===n?void 0:n.name))&&void 0!==e?e:"none",a=null===(r=this.activeViewInstance)||void 0===r||null===(i=r.engine)||void 0===i?void 0:i.allDocuments;if("none"===o||null==a||!a.length)return{mode:"none",currentDocId:""};var c=this.activeViewInstance.engine.activeDocumentIndex;return c<0&&(c=0),{mode:o,currentDocId:a[c].id}}}])&&V(t.prototype,n),o&&V(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),L={type:"Engine",name:"SearchEngine",description:"Presents Search engine module",create:function(){return new B}};i.addModule(L)}});