!function(e){function t(t){for(var i,a,u=t[0],s=t[1],c=t[2],l=0,f=[];l<u.length;l++)a=u[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(d&&d(t);f.length;)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={27:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var d=s;r.push([1145,2]),n()}({1145:function(e,t,n){e.exports=n(1146)},1146:function(e,t,n){"use strict";n.r(t);var i=n(36),o=n(10),r=n(168);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=window.__APP__.createModule,h=Object(o.c)("data-layerstack-label",""),m=[{id:"5277e6a4-9e5f-4f54-951f-dc18cfeb7530",name:"Rigid-flex",supported:!1,check:function(e){return!0}},{id:"e3df2b86-5f1b-49ca-b266-d1ae57f0ba6f",name:"Impedance Profiles",supported:!1,check:function(e){return Array.isArray(e.stackup.impedanceProfiles)&&e.stackup.impedanceProfiles.length}},{id:"0a82ba33-e4d8-43f3-9c01-412dc26bdd5e",name:"Backdrill",supported:!1,check:function(e){return!0}}];e=p({type:"View",description:"LSM View module.",create:function(e){return new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(d,e);var t,n,o,a=c(d);function d(){var e,t,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),e=a.call(this,{name:"LSMView",displayName:"Stackup",comment:"LSM View module",description:"LSM View module",order:3,dependencies:["lsm"],isHiddenByDefault:!0}),t=l(e),i=function(t){e.active&&(!t||82!==t.keyCode&&"KeyR"!==t.code||setTimeout((function(){return e.engine.resetView()}),1))},(n="onKeyUp")in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,e.logger=window.__CORE__.createLogger("LSMView"),e.isHidden=!0,e.isTopView=!1,e.showWarning=!0,e.lockedPlugin="",e}return t=d,(n=[{key:"hidden",get:function(){return this.isHidden}},{key:"events",get:function(){return["LSMView:documentChanged","LSMView:didInit","LSMView:resetView","LSMView:shown","LSMView:hidden","LSMView:documentInfo","LSMView:features","LSMView:enableSelection"]}},{key:"hasControls",value:function(e){e.push({type:"select"}),e.push({type:"zoom"}),e.push({type:"pan"}),e.push({type:"reset"})}},{key:"setup",value:function(e){var t,n,o=this;return"AltiumDesignerMultiboard"===(null===(t=e.response)||void 0===t||null===(n=t.metadata)||void 0===n?void 0:n.projectTypeName)?Promise.resolve():new Promise((function(t){o.Core=e,o.engine=o.Core.engines.LsmEngine;var n=e.response.metadata;if(o.engine){var a,u;o.isTopView="Camtastic"===n.projectTypeName;var s=o.isTopView&&(null===(a=e.response)||void 0===a||null===(u=a.storage)||void 0===u?void 0:u.files.some((function(e){return"Lsm"===e.fileType})));o.isHidden=!s,h&&"prod"!==h.toLowerCase()&&o.setBadges([Object(r.a)(h)]),window.addEventListener("keyup",o.onKeyUp),o.Core.bus.on("LsmEngine:didDocumentAttach",(function(e){o.active&&o.showWarning&&o.initWarning(),o.updateLoader(),o.Core.bus.emit("LSMView:documentChanged",e.documentId)})),o.Core.bus.on("LsmEngine:didDocumentAttachError",(function(e){var t=e.error;e.documentId,t.code===i.a.StoreExpired?o.updateLoader("error",t.message,"info-16","small"):o.updateLoader("error",t.message),o.Core.bus.emit("Document:open-error",{name:"LSM",message:t.message,error:t})})),o.Core.bus.on("LSMView:documentInfo",(function(e){var t;if(e){var n;if(e.id)n=o.engine.allDocuments.find((function(t){return t.pcbId===e.id}));else{var i=o.engine.activeDocumentIndex;n=o.engine.allDocuments[i]}if(n&&(e.id=n.pcbId,e.name=null!==(t=n.displayName)&&void 0!==t?t:n.name,n.stackup)){var r=n.stackup.stackup.stacks.find((function(e){return e.id===n.currentStackId}));r&&(e.id=n.pcbId,e.name=r.name,e.stackId=r.id)}}})),o.Core.bus.on("LSMView:resetView",(function(){return o.onResetView()})),o.Core.bus.on("LSMView:enableSelection",(function(e){o.engine.enableSelection(e)}))}t()}))}},{key:"activate",value:function(e){var t=this;this.logger.LogDebug("Activate LSM view"),this.div=e,this.active=!0,this.engine?this.engine.showView(e).then((function(n){return new Promise((function(n){t.Core.bus.emit("LSMView:shown",e),n()}))})).catch((function(e){return t.updateLoader("error",e.message)})):this.updateLoader("error","LSM engine has not found."),this.Core&&(this.hideViews(),this.showWarning&&this.initWarning())}},{key:"deactivate",value:function(){this.logger.LogDebug("Deactivate LSM view"),this.active=!1,this.Core.bus.emit("Views:updatePadding",{top:0,right:0}),this.engine&&(this.engine.hideView(),this.Core.bus.emit("LSMView:hidden")),this.updateLoader(),this.restoreViews(),this.notification.close(),this.Core.bus.emit("LsmProperties:disable")}},{key:"lockPlugin",value:function(e){e!==this.lockedPlugin&&(this.lockedPlugin&&e?this.logger.LogWarn("Try to freeze panel [".concat(e,"] then the panel [").concat(this.lockedPlugin,"] is frozen")):this.lockedPlugin=null!=e?e:"")}},{key:"onResetView",value:function(){this.engine.resetView()}},{key:"updateLoader",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"large";if(this.loader&&(this.loader.destroy(),this.loader=null),this.div&&e&&t){var o={message:t,type:e,size:i};n&&(o.icon=n),this.loader=window.__APP__.loader(this.div,o)}}},{key:"hideViews",value:function(){var e=this;this.isTopView||Object.keys(this.Core.views).forEach((function(t){e.Core.bus.emit("".concat(t,":updateInterface"),{hidden:"LSMView"!==t})})),this.Core.bus.emit("HelpPanel:updateInterface",{hidden:!0}),this.Core.bus.emit("LsmProperties:updateInterface",{hidden:!1})}},{key:"restoreViews",value:function(){var e=this;this.isTopView||Object.values(this.Core.views).forEach((function(t){var n,i;e.Core.bus.emit("".concat(null==t||null===(n=t.metaInfo)||void 0===n?void 0:n.name,":updateInterface"),{hidden:"LSMView"===(null==t||null===(i=t.metaInfo)||void 0===i?void 0:i.name)||(null==t?void 0:t.hidden)})})),this.Core.bus.emit("HelpPanel:updateInterface",{hidden:!1}),this.Core.bus.emit("LsmProperties:updateInterface",{hidden:!0})}},{key:"getWarningMessage",value:function(){var e=this.getFeatures();if(Array.isArray(e)&&e.length){var t="Note: The following features are not displayed in the Web UI: ";return e.forEach((function(e,n){t+=n?", ".concat(e.name):e.name})),t}return""}},{key:"getFeatures",value:function(){var e=this.engine.activeDocumentIndex,t=this.engine.allDocuments[e];if(null!=t&&t.stackup)return m.filter((function(e){return t.stackup.featureSet.some((function(n){return n.id===e.id&&e.check(t.stackup)}))}))}},{key:"initWarning",value:function(){var e=this,t=this.getWarningMessage();this.notification||(this.notification=window.__APP__.notification(document.querySelector("#viewer-app"))),t&&this.notification.update({text:t})&&this.notification.open(),this.notification.onClose((function(){e.showWarning=!1}))}}])&&u(t.prototype,n),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(e))}});window.__CORE__&&window.__CORE__.addModule(e)}});